<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Tabla Formulario</title>
    <link rel="stylesheet" href="estilos.css">
    <script src="../proveedores.js"></script>
    <script src="../condicionesIVA.js"></script>
</head>
<body>
    <header>
        <h2>Proveedores</h2>
        <div>
            <button id="botonCargar">Cargar datos</button>
            <button id="botonVaciar">Vaciar datos</button>
            <button id="botonCargarForm">CargarForm</button>
        </div>
    </header>
    <main>
        <div id="contenedorTabla" class="contenedorActivo">
            <table>
                <thead>
                    <tr>
                        <th>Código</th>
                        <th>Razón Social</th>
                        <th>CUIT</th>
                        <th>Condición IVA</th>
                        <th>Saldo Cta. Cte.</th>
                        <th>Certificados Calidad</th>
                    </tr>
                </thead>
                <tbody id="tablaBody">
                </tbody>
                <tfoot>
                    <tr>
                        <td>s código</td>
                        <td>s razón social</td>
                        <td>s cuit</td>
                        <td>s condición iva</td>
                        <td>s saldo cta. cte.</td>
                        <td>s certificados calidad</td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </main>
    <div id="ventanaModal" class="ventanaModalApagado">
        <div class="modalContenido">
            <div class="modalHeader">
                <span>Encabezado Modal</span>
                <button id="cerrarModal" class="cerrarModal">X</button>
            </div>
            <iframe src="../esp05FormVariableArregloDeObjetos/index.html"></iframe>
        </div>
    </div>
    <footer>
        <span>Pie</span>
    </footer>
    <script>
    const columnas = [
        { campo: "CodProveedor", titulo: "Código" },
        { campo: "RazonSocial", titulo: "Razón Social" },
        { campo: "CUIT", titulo: "CUIT" },
        { campo: "idIVA", titulo: "Condición IVA" },
        { campo: "SaldoCuentaCorriente", titulo: "Saldo Cta. Cte." },
        { campo: "CertificadosCalidad", titulo: "Certificados Calidad" }
    ];

    function crearFilas(datos) {
        const tbody = document.getElementById('tablaBody');
        while (tbody.firstChild) {
            tbody.removeChild(tbody.firstChild);
        }
        datos.forEach(function(item) {
            var objTr = document.createElement("tr");
            columnas.forEach(function(col) {
                var objTd = document.createElement("td");
                objTd.setAttribute("campo-dato", col.campo);
                if (col.campo === "idIVA") {
                    var iva = condicionesIVAJSON.condicionesIVA.find(function(c) { return c.idIVA === item.idIVA; });
                    objTd.innerHTML = iva ? iva.tipoIVA : "";
                } else {
                    objTd.innerHTML = item[col.campo];
                }
                objTr.appendChild(objTd);
            });
            tbody.appendChild(objTr);
        });
    }

    document.getElementById('botonCargar').addEventListener('click', function() {
        crearFilas(proveedoresJSON.proveedores);
    });

    document.getElementById('botonVaciar').addEventListener('click', function() {
        var tbody = document.getElementById('tablaBody');
        while (tbody.firstChild) {
            tbody.removeChild(tbody.firstChild);
        }
    });

    const contenedorTabla = document.getElementById('contenedorTabla');
    const modal = document.getElementById('ventanaModal');
    const abrirForm = document.getElementById('botonCargarForm');
    const cerrar = document.getElementById('cerrarModal');

    abrirForm.addEventListener('click', function() {
        contenedorTabla.classList.remove('contenedorActivo');
        contenedorTabla.classList.add('contenedorPasivo');
        modal.classList.remove('ventanaModalApagado');
        modal.classList.add('ventanaModalPrendido');
    });
    cerrar.addEventListener('click', function() {
        contenedorTabla.classList.remove('contenedorPasivo');
        contenedorTabla.classList.add('contenedorActivo');
        modal.classList.remove('ventanaModalPrendido');
        modal.classList.add('ventanaModalApagado');
    });
    </script>
</body>
</html>
